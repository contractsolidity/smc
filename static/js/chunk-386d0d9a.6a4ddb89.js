(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-386d0d9a"],{"3d0c":function(e,t,n){"use strict";n.r(t);n("a9e3");var r=n("7a23"),a=n("53d4"),c=n.n(a),i=n("e5ab"),s=n.n(i),o=n("44fd"),d=n.n(o),l=n("b884"),u=n.n(l),b={class:"nft-box"},f={key:0,src:c.a,alt:""},O={key:1,src:s.a,alt:""},j={key:2,src:d.a,alt:""},m={key:3,src:u.a,alt:""},p={class:"desc-box flex-item"},g={key:0,class:"name"},w={key:1,class:"name"},h={key:2,class:"name"},v={key:3,class:"name"},x={class:"row flex-between"},k={class:"row-title"},y={class:"row-value"},C={class:"row flex-between"},A={class:"row-title"},R={class:"row-value"},D={class:"row flex-between"},S={class:"row-title"},L={class:"row-value"},N={class:"row flex-between"},B={class:"row-title"},U={class:"row-value"},T={class:"row flex-between"},V={class:"row-title"},$={class:"row-value"},I={class:"nft-btn-box flex-between"};function M(e,t,n,a,c,i){var s=Object(r["K"])("HeadTop"),o=Object(r["K"])("van-count-down"),d=Object(r["K"])("van-button"),l=Object(r["K"])("van-list");return Object(r["D"])(),Object(r["h"])(l,{loading:e.loading,"onUpdate:loading":t[0]||(t[0]=function(t){return e.loading=t}),"immediate-check":!1,error:e.error,"onUpdate:error":t[1]||(t[1]=function(t){return e.error=t}),"error-text":e.$t("index.请求失败，点击重新加载"),finished:e.finished,"finished-text":e.$t("index.没有更多了"),onLoad:e.onLoad},{default:Object(r["V"])((function(){return[Object(r["k"])("div",b,[Object(r["m"])(s,{title:e.$t("index.卡牌质押状态"),isShowTop:!0,isSubHeader:!1},null,8,["title"]),(Object(r["D"])(!0),Object(r["j"])(r["a"],null,Object(r["J"])(e.list,(function(t,n){return Object(r["D"])(),Object(r["j"])("div",{class:"nft-item flex-middle",key:n},[t.nftAddress==e.config.nftAddress?(Object(r["D"])(),Object(r["j"])("img",f)):Object(r["i"])("",!0),t.nftAddress==e.config.kingCardAddress?(Object(r["D"])(),Object(r["j"])("img",O)):Object(r["i"])("",!0),t.nftAddress==e.config.gloryCardAddress?(Object(r["D"])(),Object(r["j"])("img",j)):Object(r["i"])("",!0),t.nftAddress==e.config.magellanicCloudCardAddress?(Object(r["D"])(),Object(r["j"])("img",m)):Object(r["i"])("",!0),Object(r["k"])("div",p,[t.nftAddress==e.config.nftAddress?(Object(r["D"])(),Object(r["j"])("div",g,"Supreme Card #"+Object(r["O"])(t.tokenId),1)):Object(r["i"])("",!0),t.nftAddress==e.config.kingCardAddress?(Object(r["D"])(),Object(r["j"])("div",w,"King Card #"+Object(r["O"])(t.tokenId),1)):Object(r["i"])("",!0),t.nftAddress==e.config.gloryCardAddress?(Object(r["D"])(),Object(r["j"])("div",h,"Glory Card #"+Object(r["O"])(t.tokenId),1)):Object(r["i"])("",!0),t.nftAddress==e.config.magellanicCloudCardAddress?(Object(r["D"])(),Object(r["j"])("div",v,"Magellanic Cloud Card #"+Object(r["O"])(t.tokenId),1)):Object(r["i"])("",!0),Object(r["k"])("div",x,[Object(r["k"])("div",k,Object(r["O"])(e.$t("index.总产出价值")),1),Object(r["k"])("div",y,Object(r["O"])(t.totalBackAmount)+"USDT",1)]),Object(r["k"])("div",C,[Object(r["k"])("div",A,Object(r["O"])(e.$t("index.日产出价值")),1),Object(r["k"])("div",R,Object(r["O"])(t.dayBackAmount)+"USDT",1)]),Object(r["k"])("div",D,[Object(r["k"])("div",S,Object(r["O"])(e.$t("index.已产出价值")),1),Object(r["k"])("div",L,Object(r["O"])(t.haveBackAmount)+"USDT",1)]),Object(r["k"])("div",N,[Object(r["k"])("div",B,Object(r["O"])(e.$t("index.待领取数量")),1),Object(r["k"])("div",U,Object(r["O"])(t.reward)+"SMC",1)]),Object(r["k"])("div",T,[Object(r["k"])("div",V,Object(r["O"])(e.$t("index.领取倒计时")),1),Object(r["k"])("div",$,[Object(r["m"])(o,{time:1e3*t.cutDownTime},null,8,["time"])])]),Object(r["k"])("div",I,[Number(t.totalBackAmount)>Number(t.haveBackAmount)?(Object(r["D"])(),Object(r["h"])(d,{key:0,style:{width:"48.5%"},round:"",type:"primary",size:"small",onClick:function(n){return e.withdrawReward(t.id)}},{default:Object(r["V"])((function(){return[Object(r["l"])(Object(r["O"])(e.$t("index.领取")),1)]})),_:2},1032,["onClick"])):Number(e.allowance)>0?(Object(r["D"])(),Object(r["h"])(d,{key:1,style:{width:"48.5%"},round:"",loading:e.nftLoading[t.id],type:"primary",size:"small",onClick:function(n){return e.reinvest(t)}},{default:Object(r["V"])((function(){return[Object(r["l"])(Object(r["O"])(e.$t("index.复投")),1)]})),_:2},1032,["loading","onClick"])):(Object(r["D"])(),Object(r["h"])(d,{key:2,style:{width:"48.5%"},round:"",loading:e.btn.loading,type:"primary",size:"small",onClick:e.approve},{default:Object(r["V"])((function(){return[Object(r["l"])(Object(r["O"])(e.$t("index.授权"))+" SMC",1)]})),_:1},8,["loading","onClick"])),Number(e.allowance)>0?(Object(r["D"])(),Object(r["h"])(d,{key:3,style:{width:"48.5%"},round:"",loading:e.nftLoading[t.id],type:"primary",size:"small",onClick:function(n){return e.release(t)}},{default:Object(r["V"])((function(){return[Object(r["l"])(Object(r["O"])(e.$t("index.解押")),1)]})),_:2},1032,["loading","onClick"])):(Object(r["D"])(),Object(r["h"])(d,{key:4,style:{width:"48.5%"},round:"",loading:e.btn.loading,type:"primary",size:"small",onClick:e.approve},{default:Object(r["V"])((function(){return[Object(r["l"])(Object(r["O"])(e.$t("index.授权"))+" SMC",1)]})),_:1},8,["loading","onClick"]))])])])})),128))])]})),_:1},8,["loading","error","error-text","finished","finished-text","onLoad"])}var _=n("5530"),z=n("1da1"),K=(n("4de4"),n("d3b7"),n("159b"),n("b680"),n("96cf"),n("1a2e")),F=n("5502"),H=n("01ea"),J=n("722f"),P=n("440b"),E=n("47e2"),W=n("9d56"),G=n("901e"),q=n.n(G),Q=n("626a"),X=n("70a9"),Y={components:{HeadTop:K["a"]},setup:function(){var e=Object(F["b"])(),t=Object(E["b"])(),n=t.t,a=Object(r["H"])({address:Object(r["f"])((function(){return e.state.accounts[0]})),web3:Object(r["f"])((function(){return e.state.provider})),locale:Object(r["f"])((function(){return e.state.locale})),SOULContract:null,SOULBalance:"0.00",reward:"0.00",allowance:"0.00",nftLoading:{},list:[],btn:{loading:!1},page:1,limit:5,loading:!1,error:!1,finished:!1,config:H["a"],initContract:function(){a.SOULContract=new a.web3.eth.Contract(J,H["a"].SOULAddress),a.investContract=new a.web3.eth.Contract(P,H["a"].investAddress),a.initData(),a.nftLoading[H["a"].nftAddress]=!1},initData:function(){a.getBalance(),a.getAllowance(),a.page=1,a.list=[],a.getUserRecords()},onLoad:function(){a.page++,a.getUserRecords()},getBalance:function(){var e=Object(z["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.SOULContract.methods.balanceOf(a.address).call();case 2:t=e.sent,a.SOULBalance=t;case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getAllowance:function(){var e=Object(z["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.SOULContract.methods.allowance(a.address,H["a"].investAddress).call();case 2:t=e.sent,a.allowance=t;case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),approve:function(){var e=Object(z["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.btn.loading=!0,e.prev=1,e.next=4,a.SOULContract.methods.approve(H["a"].investAddress,W["b"]).send({from:a.address});case 4:a.getAllowance(),a.btn.loading=!1,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),a.btn.loading=!1;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(){return e.apply(this,arguments)}return t}(),getUserRecords:function(){var e=Object(z["a"])(regeneratorRuntime.mark((function e(){var t,n,r,c,i,s,o,d,l,u,b,f,O;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],n=[],r=[],e.next=5,a.investContract.methods.getAllStakeType().call();case 5:return c=e.sent,e.next=8,a.investContract.methods.getUserRecords(a.address,a.page,a.limit).call();case 8:return i=e.sent,e.next=11,a.investContract.methods.getCurTime().call();case 11:return s=e.sent,o=i.recordArr.filter((function(e){return 1==e.isExist})),o.forEach((function(e){n.push({reference:"canWithdrawAmount",methodName:"getCanWithdrawAmount",methodParameters:[e.nftAddress,e.tokenId]}),r.push({reference:"nftInfo",methodName:"getNftInfos",methodParameters:[[e.nftAddress],[e.tokenId]]})})),d=[{reference:"amount",contractAddress:H["a"].investAddress,abi:P,calls:n},{reference:"info",contractAddress:H["a"].investAddress,abi:P,calls:r}],l=new X["a"]({multicallCustomContractAddress:H["a"].multicallAddress,web3Instance:a.web3,tryAggregate:!1}),e.next=20,l.call(d);case 20:for(u=e.sent,b=function(e){var n=c.filter((function(t){return t.nftAddress==u.results.info.callsReturnContext[e].returnValues[0][0]}))[0],r=a.web3.utils.hexToNumberString(u.results.info.callsReturnContext[e].returnValues[0][4].hex),i=s-r>=86400?0:Number(r)+Number(86400)-s;t.push({id:o[e].id,cuyday:a.web3.utils.hexToNumberString(u.results.info.callsReturnContext[e].returnValues[0][3].hex),backDay:n.backDay,nftAddress:u.results.info.callsReturnContext[e].returnValues[0][0],tokenId:a.web3.utils.hexToNumberString(u.results.info.callsReturnContext[e].returnValues[0][1].hex),dayBackAmount:new q.a(n.dayBackAmount).dividedBy(Math.pow(10,18)).toFixed(1),totalBackAmount:new q.a(n.backUsdtAmount).dividedBy(Math.pow(10,18)).toFixed(1),haveBackAmount:new q.a(a.web3.utils.hexToNumberString(u.results.info.callsReturnContext[e].returnValues[0][2].hex)).dividedBy(Math.pow(10,18)).toFixed(1),reward:new q.a(a.web3.utils.hexToNumberString(u.results.amount.callsReturnContext[e].returnValues[0].hex)).dividedBy(Math.pow(10,18)).toFixed(3),cutDownTime:i})},f=0;f<o.length;f++)b(f);1===a.page?a.list=t:(O=a.list).push.apply(O,t),a.loading=!1,a.finished=!(Math.ceil(i.total/a.limit)>a.page);case 28:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),withdrawReward:function(){var e=Object(z["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.investContract.methods.withdrawReward(t).send({from:a.address});case 3:Object(Q["a"])(n("index.领取成功")),a.initData(),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),Object(Q["a"])(n("index.领取失败"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}(),release:function(){var e=Object(z["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(Number(t.cuyday)<Number(t.backDay))){e.next=8;break}return e.next=3,a.investContract.methods.getReleaseNeedAmount(t.nftAddress,t.tokenId).call();case 3:if(r=e.sent,!(Number(r)>Number(a.SOULBalance))){e.next=8;break}return Object(Q["a"])(n("index.SMC余额不足")),e.abrupt("return");case 8:return a.nftLoading[t.id]=!0,e.prev=9,e.next=12,a.investContract.methods.release(t.id).send({from:a.address});case 12:a.nftLoading[t.id]=!1,Object(Q["a"])(n("index.解押成功")),a.initData(),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](9),a.nftLoading[t.id]=!1,Object(Q["a"])(n("index.解押失败"));case 21:case"end":return e.stop()}}),e,null,[[9,17]])})));function t(t){return e.apply(this,arguments)}return t}(),reinvest:function(){var e=Object(z["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.investContract.methods.getResetNeedAmount(t.nftAddress).call();case 2:if(r=e.sent,!(Number(r)>Number(a.SOULBalance))){e.next=7;break}return Object(Q["a"])(n("index.SMC余额不足")),e.abrupt("return");case 7:return a.nftLoading[t.id]=!0,e.prev=8,e.next=11,a.investContract.methods.resetNftByOrder(t.id).send({from:a.address});case 11:a.nftLoading[t.id]=!1,Object(Q["a"])(n("index.复投成功")),a.initData(),e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](8),a.nftLoading[t.id]=!1,Object(Q["a"])(n("index.复投失败"));case 20:case"end":return e.stop()}}),e,null,[[8,16]])})));function t(t){return e.apply(this,arguments)}return t}()});a.address&&a.initContract(),Object(r["T"])((function(){return a.address}),(function(e){e&&a.initContract()}));var c=Object(r["P"])(a);return Object(_["a"])({},c)}},Z=(n("ba0f"),n("6b0d")),ee=n.n(Z);const te=ee()(Y,[["render",M],["__scopeId","data-v-39a3a050"]]);t["default"]=te},4263:function(e,t,n){},"44fd":function(e,t,n){e.exports=n.p+"static/img/glory.47849bf7.jpg"},"53d4":function(e,t,n){e.exports=n.p+"static/img/supreme.91e07eef.jpg"},b884:function(e,t,n){e.exports=n.p+"static/img/mage.9a4fe52d.jpg"},ba0f:function(e,t,n){"use strict";n("4263")},e5ab:function(e,t,n){e.exports=n.p+"static/img/king.cd228b0f.jpg"}}]);
//# sourceMappingURL=chunk-386d0d9a.6a4ddb89.js.map