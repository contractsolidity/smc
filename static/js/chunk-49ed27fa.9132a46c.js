(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49ed27fa"],{5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var a=n("e330"),r=n("1d80"),i=n("577e"),s=n("5899"),c=a("".replace),o="["+s+"]",d=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),l=function(e){return function(t){var n=i(r(t));return 1&e&&(n=c(n,d,"")),2&e&&(n=c(n,u,"")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},"722f":function(e){e.exports=JSON.parse('[{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"symbol","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}]')},a9e3:function(e,t,n){"use strict";var a=n("83ab"),r=n("da84"),i=n("e330"),s=n("94ca"),c=n("6eeb"),o=n("1a2d"),d=n("7156"),u=n("3a9b"),l=n("d9b5"),p=n("c04e"),b=n("d039"),f=n("241c").f,y=n("06cf").f,m=n("9bf2").f,O=n("408a"),j=n("58a8").trim,g="Number",v=r[g],w=v.prototype,k=r.TypeError,h=i("".slice),x=i("".charCodeAt),A=function(e){var t=p(e,"number");return"bigint"==typeof t?t:T(t)},T=function(e){var t,n,a,r,i,s,c,o,d=p(e,"number");if(l(d))throw k("Cannot convert a Symbol value to a number");if("string"==typeof d&&d.length>2)if(d=j(d),t=x(d,0),43===t||45===t){if(n=x(d,2),88===n||120===n)return NaN}else if(48===t){switch(x(d,1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+d}for(i=h(d,2),s=i.length,c=0;c<s;c++)if(o=x(i,c),o<48||o>r)return NaN;return parseInt(i,a)}return+d};if(s(g,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var C,L=function(e){var t=arguments.length<1?0:v(A(e)),n=this;return u(w,n)&&b((function(){O(n)}))?d(Object(t),n,L):t},M=a?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),S=0;M.length>S;S++)o(v,C=M[S])&&!o(L,C)&&m(L,C,y(v,C));L.prototype=w,w.constructor=L,c(r,g,L)}},aec7:function(e,t,n){"use strict";n("d296")},c074:function(e,t,n){"use strict";n.r(t);n("a9e3");var a=n("7a23"),r=n("53d4"),i=n.n(r),s=n("e5ab"),c=n.n(s),o=n("44fd"),d=n.n(o),u=n("b884"),l=n.n(u),p=function(e){return Object(a["G"])("data-v-7d076888"),e=e(),Object(a["E"])(),e},b={class:"flex-between",style:{padding:"15px 15px 10px"}},f=p((function(){return Object(a["k"])("span",null,null,-1)})),y={class:"nft-box"},m={key:0,src:i.a,alt:""},O={key:1,src:c.a,alt:""},j={key:2,src:d.a,alt:""},g={key:3,src:l.a,alt:""},v={class:"desc-box flex-item"},w={key:0,class:"name"},k={key:1,class:"name"},h={key:2,class:"name"},x={key:3,class:"name"},A={class:"row flex-between"},T={class:"row-title"},C={class:"row-value"},L={class:"row flex-between"},M={class:"row-title"},S={class:"row-value"},I={class:"row flex-between"},N={class:"row-title"},D={class:"row-value"},U={class:"row flex-between"},R={class:"row-title"},B={class:"row-value"},E={class:"nft-btn-box flex-between"};function _(e,t,n,r,i,s){var c=Object(a["K"])("van-button"),o=Object(a["K"])("HeadTop"),d=Object(a["K"])("van-list");return Object(a["D"])(),Object(a["h"])(d,{loading:e.loading,"onUpdate:loading":t[1]||(t[1]=function(t){return e.loading=t}),"immediate-check":!1,error:e.error,"onUpdate:error":t[2]||(t[2]=function(t){return e.error=t}),"error-text":e.$t("index.请求失败，点击重新加载"),finished:e.finished,"finished-text":e.$t("index.没有更多了"),onLoad:e.onLoad},{default:Object(a["V"])((function(){return[Object(a["k"])("div",b,[f,Object(a["m"])(c,{style:{padding:"0 15px"},round:"",border:"",type:"primary",size:"small",onClick:t[0]||(t[0]=function(t){return e.$router.push({name:"MarketMy"})})},{default:Object(a["V"])((function(){return[Object(a["l"])(Object(a["O"])(e.$t("index.我的挂单")),1)]})),_:1})]),Object(a["k"])("div",y,[Object(a["m"])(o,{title:e.$t("index.NFT市场"),isShowTop:!0,isSubHeader:!1},null,8,["title"]),(Object(a["D"])(!0),Object(a["j"])(a["a"],null,Object(a["J"])(e.list,(function(t,n){return Object(a["D"])(),Object(a["j"])("div",{class:"nft-item flex-middle",key:n},[t.nftAddress==e.config.nftAddress?(Object(a["D"])(),Object(a["j"])("img",m)):Object(a["i"])("",!0),t.nftAddress==e.config.kingCardAddress?(Object(a["D"])(),Object(a["j"])("img",O)):Object(a["i"])("",!0),t.nftAddress==e.config.gloryCardAddress?(Object(a["D"])(),Object(a["j"])("img",j)):Object(a["i"])("",!0),t.nftAddress==e.config.magellanicCloudCardAddress?(Object(a["D"])(),Object(a["j"])("img",g)):Object(a["i"])("",!0),Object(a["k"])("div",v,[t.nftAddress==e.config.nftAddress?(Object(a["D"])(),Object(a["j"])("div",w,"Supreme Card #"+Object(a["O"])(t.tokenId),1)):Object(a["i"])("",!0),t.nftAddress==e.config.kingCardAddress?(Object(a["D"])(),Object(a["j"])("div",k,"King Card #"+Object(a["O"])(t.tokenId),1)):Object(a["i"])("",!0),t.nftAddress==e.config.gloryCardAddress?(Object(a["D"])(),Object(a["j"])("div",h,"Glory Card #"+Object(a["O"])(t.tokenId),1)):Object(a["i"])("",!0),t.nftAddress==e.config.magellanicCloudCardAddress?(Object(a["D"])(),Object(a["j"])("div",x,"Magellanic Cloud Card #"+Object(a["O"])(t.tokenId),1)):Object(a["i"])("",!0),Object(a["k"])("div",A,[Object(a["k"])("div",T,Object(a["O"])(e.$t("index.出售地址")),1),Object(a["k"])("div",C,Object(a["O"])(t.seller.substring(0,8)+"....."+t.seller.substring(t.seller.length-8,t.seller.length)),1)]),Object(a["k"])("div",L,[Object(a["k"])("div",M,Object(a["O"])(e.$t("index.售价")),1),Object(a["k"])("div",S,Object(a["O"])(t.price)+Object(a["O"])(t.payTokenSymbol),1)]),Object(a["k"])("div",I,[Object(a["k"])("div",N,Object(a["O"])(e.$t("index.总产出价值")),1),Object(a["k"])("div",D,Object(a["O"])(t.totalBackAmount)+"USDT",1)]),Object(a["k"])("div",U,[Object(a["k"])("div",R,Object(a["O"])(e.$t("index.已产出价值")),1),Object(a["k"])("div",B,Object(a["O"])(t.haveBackAmount)+"USDT",1)]),Object(a["k"])("div",E,[t.payToken==e.config.usdtAddress?(Object(a["D"])(),Object(a["j"])(a["a"],{key:0},[Number(e.usdtAllowance)>0?(Object(a["D"])(),Object(a["h"])(c,{key:0,style:{width:"48.5%"},round:"",loading:e.nftLoading[t.orderId],type:"primary",size:"small",onClick:function(n){return e.buy(t)}},{default:Object(a["V"])((function(){return[Object(a["l"])(Object(a["O"])(e.$t("index.购买")),1)]})),_:2},1032,["loading","onClick"])):(Object(a["D"])(),Object(a["h"])(c,{key:1,style:{width:"48.5%"},round:"",loading:e.approveLoading["usdt"],type:"primary",size:"small",onClick:e.approveUsdt},{default:Object(a["V"])((function(){return[Object(a["l"])(Object(a["O"])(e.$t("index.授权"))+" USDT",1)]})),_:1},8,["loading","onClick"]))],64)):Object(a["i"])("",!0),t.payToken==e.config.SOULAddress?(Object(a["D"])(),Object(a["j"])(a["a"],{key:1},[Number(e.allowance)>0?(Object(a["D"])(),Object(a["h"])(c,{key:0,style:{width:"48.5%"},round:"",loading:e.nftLoading[t.orderId],type:"primary",size:"small",onClick:function(n){return e.buy(t)}},{default:Object(a["V"])((function(){return[Object(a["l"])(Object(a["O"])(e.$t("index.购买")),1)]})),_:2},1032,["loading","onClick"])):(Object(a["D"])(),Object(a["h"])(c,{key:1,style:{width:"48.5%"},round:"",loading:e.approveLoading["smc"],type:"primary",size:"small",onClick:e.approve},{default:Object(a["V"])((function(){return[Object(a["l"])(Object(a["O"])(e.$t("index.授权"))+" SMC",1)]})),_:1},8,["loading","onClick"]))],64)):Object(a["i"])("",!0)])])])})),128))])]})),_:1},8,["loading","error","error-text","finished","finished-text","onLoad"])}var F=n("5530"),$=n("1da1"),V=(n("96cf"),n("b680"),n("4de4"),n("d3b7"),n("159b"),n("1a2e")),z=n("5502"),G=n("01ea"),H=n("722f"),J=n("7d26"),K=n("440b"),P=n("47e2"),X=n("9d56"),Y=n("901e"),q=n.n(Y),Q=n("626a"),W={components:{HeadTop:V["a"]},setup:function(){var e=Object(z["b"])(),t=Object(P["b"])(),n=t.t,r=Object(a["H"])({address:Object(a["f"])((function(){return e.state.accounts[0]})),web3:Object(a["f"])((function(){return e.state.provider})),locale:Object(a["f"])((function(){return e.state.locale})),SOULContract:null,usdtContract:null,investContract:null,SOULBalance:"0.00",allowance:"0.00",usdtBalance:"0.00",usdtAllowance:"0.00",list:[],approveLoading:{},nftLoading:{},page:1,limit:5,loading:!1,error:!1,finished:!1,config:G["a"],initContract:function(){r.SOULContract=new r.web3.eth.Contract(H,G["a"].SOULAddress),r.usdtContract=new r.web3.eth.Contract(H,G["a"].usdtAddress),r.marketContract=new r.web3.eth.Contract(J,G["a"].nftMarketAddress),r.investContract=new r.web3.eth.Contract(K,G["a"].investAddress),r.initData()},initData:function(){r.getUsdtBalance(),r.getUsdtAllowance(),r.getBalance(),r.getAllowance(),r.page=1,r.list=[],r.getOrders()},getUsdtBalance:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.usdtContract.methods.balanceOf(r.address).call();case 2:t=e.sent,r.usdtBalance=new q.a(t).dividedBy(Math.pow(10,18)).toFixed(2,1);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getUsdtAllowance:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.usdtContract.methods.allowance(r.address,G["a"].nftMarketAddress).call();case 2:t=e.sent,r.usdtAllowance=t;case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getBalance:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.SOULContract.methods.balanceOf(r.address).call();case 2:t=e.sent,r.SOULBalance=new q.a(t).dividedBy(Math.pow(10,18)).toFixed(2,1);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getAllowance:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.SOULContract.methods.allowance(r.address,G["a"].nftMarketAddress).call();case 2:t=e.sent,r.allowance=t;case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),approve:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.approveLoading["smc"]=!0,e.prev=1,e.next=4,r.SOULContract.methods.approve(G["a"].nftMarketAddress,X["b"]).send({from:r.address});case 4:r.getAllowance(),r.approveLoading["smc"]=!1,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),r.approveLoading["smc"]=!1;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(){return e.apply(this,arguments)}return t}(),approveUsdt:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.approveLoading["usdt"]=!0,e.prev=1,e.next=4,r.usdtContract.methods.approve(G["a"].nftMarketAddress,X["b"]).send({from:r.address});case 4:r.getUsdtAllowance(),r.approveLoading["usdt"]=!0,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),r.approveLoading["usdt"]=!0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(){return e.apply(this,arguments)}return t}(),onLoad:function(){r.page++,r.getOrders()},getOrders:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(){var t,n,a,i,s,c,o,d,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],e.next=3,r.investContract.methods.getAllStakeType().call();case 3:return n=e.sent,e.next=6,r.marketContract.methods.getSupportTokens().call();case 6:return a=e.sent,e.next=9,r.marketContract.methods.getAllRecords(r.page,r.limit).call();case 9:return i=e.sent,s=[],c=[],o=i.recordArr.filter((function(e){return 1==e.isExist})),o.forEach((function(e){s.push(e.nftAddress),c.push(e.tokenId)})),e.next=17,r.investContract.methods.getNftInfos(s,c).call();case 17:d=e.sent,o.forEach((function(e,r){var i=n.filter((function(t){return t.nftAddress==e.nftAddress}))[0],s=a.filter((function(t){return String(e.payToken).toLowerCase()==String(t.tokenAddress).toLowerCase()}))[0];t.push(Object.assign({},e,{price:new q.a(e.price).dividedBy(Math.pow(10,s.decimals)).toFixed(2),payTokenSymbol:s.symbol,payTokenDecimals:s.decimals,dayBackAmount:new q.a(i.dayBackAmount).dividedBy(Math.pow(10,18)).toFixed(1),totalBackAmount:new q.a(i.backUsdtAmount).dividedBy(Math.pow(10,18)).toFixed(1),haveBackAmount:new q.a(d[r].havebackUsdtAmount).dividedBy(Math.pow(10,18)).toFixed(1)}))})),1===r.page?r.list=t:(u=r.list).push.apply(u,t),r.loading=!1,r.finished=!(Math.ceil(i.total/r.limit)>r.page);case 24:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),buy:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new r.web3.eth.Contract(H,t.payToken),e.next=3,a.methods.balanceOf(r.address).call();case 3:if(i=e.sent,!(Number(t.price)>Number(i/Math.pow(10,t.payTokenDecimals)))){e.next=7;break}return Object(Q["a"])(n("index.余额不足")),e.abrupt("return");case 7:return r.nftLoading[t.orderId]=!0,e.prev=8,e.next=11,r.marketContract.methods.buyOrder(t.orderId).send({from:r.address});case 11:r.nftLoading[t.orderId]=!1,Object(Q["a"])(n("index.购买成功")),r.initData(),e.next=21;break;case 16:e.prev=16,e.t0=e["catch"](8),r.nftLoading[t.id]=!1,Object(Q["a"])(n("index.购买失败"));case 21:case"end":return e.stop()}}),e,null,[[8,16]])})));function t(t){return e.apply(this,arguments)}return t}()});r.address&&r.initContract(),Object(a["T"])((function(){return r.address}),(function(e){e&&r.initContract()}));var i=Object(a["P"])(r);return Object(F["a"])({},i)}},Z=(n("aec7"),n("6b0d")),ee=n.n(Z);const te=ee()(W,[["render",_],["__scopeId","data-v-7d076888"]]);t["default"]=te},d296:function(e,t,n){}}]);
//# sourceMappingURL=chunk-49ed27fa.9132a46c.js.map